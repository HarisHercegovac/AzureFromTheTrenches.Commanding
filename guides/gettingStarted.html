<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Getting Started </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Getting Started ">
    <meta name="generator" content="docfx 2.48.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" width="56" height="52" src="../images/largeLogo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="getting-started">Getting Started</h1>

<p>Firstly install the nuget package for commanding:</p>
<pre><code>Install-Package AzureFromTheTrenches.Commanding
</code></pre><p>As an example let&#39;s create a command that adds two numbers together and returns a result:</p>
<pre><code class="lang-c#">public class MathResult
{
    public int Value { get; set; }
}

public class AddCommand : ICommand&lt;MathResult&gt;
{
    public int FirstNumber { get; set; }

    public int SecondNumber { get; set; }
}
</code></pre><p>Commands are acted on by handlers and our add handler looks like this:</p>
<pre><code class="lang-c#">public AddCommandHandler : ICommandHandler&lt;AddCommand, MathResult&gt;
{
    public Task&lt;MathResult&gt; ExecuteAsync(AddCommand command, MathResult previousResult)
    {
        return new MathResult {
            Value = command.FirstNumber + command.SecondNumber
        };
    }
}
</code></pre><p>Having defined our command, result and handler, we need to register these with the commanding system. If you&#39;re just writing a console app you can do this in Program.cs but for more realistic usage you&#39;d do this where you configure your IoC container - it&#39;s handy to think of command registrations as just another part of your applications configuration, besides which you&#39;ll need access to the container. The example below demonstrates registration with the Microsoft ASP.Net Core Service Provider:</p>
<p>In your Startup.cs add a private variable to hold the IServiceProvider which we&#39;ll need to use when registering the commanding system.</p>
<p><code>private IServiceProvider _serviceProvider;</code></p>
<p>Now in your <code>Configure(IApplicationBuilder app, IHostingEnvironment env)</code> method assign this variable with the app.ApplicationServices.</p>
<p><code>_serviceProvider = app.ApplicationServices;</code></p>
<p>Once this is done, we can get the commanding framework registered within the <code>ConfigureServices(IServiceCollection services)</code> method. Add the following lines of code.</p>
<pre><code class="lang-c#">var adapter = new CommandingDependencyResolverAdapter(
    (fromType, toInstance) =&gt; services.AddSingleton(fromType, toInstance),
    (fromType, toType) =&gt; services.AddTransient(fromType, toType),
    (resolveTo) =&gt; _serviceProvider.GetService(resolveTo));

var registry = adapter.AddCommanding();
</code></pre><p>The commanding framework is now registered, and we can register our handler(s) using the registry variable</p>
<p><code>registry.Register&lt;AddCommandHandler&gt;();</code></p>
<p>The <em>CommandingDependencyResolverAdapter</em> class is an adapter that allows the framework to be registed with any IoC container and the <em>AddCommanding</em> method registers the injectable commanding interfaces and returns an <em>ICommandRegistry</em> interface that allows you to register handlers - you only need to register a handler, the framework will figure out the rest and registration uses a fluent API style for concise readable code.</p>
<p>To dispatch our command we need to get hold of the ICommandDispatcher interface and send the command. We&#39;ll do that and output the result to the console:</p>
<pre><code class="lang-c#">ICommandDispatcher commandDispatcher = dependencyResolver.ServiceProvider.GetService&lt;ICommandDispatcher&gt;();
MathResult mathResult = await commandDispatcher.DispatchAsync(new AddCommand { FirstNumber = 5, SecondNumber = 6});
Console.WriteLine(mathResult.Value); // hopefully says 11
</code></pre><p>And for simple usage that&#39;s it. This example is a bit contrived as we&#39;re resolving dependencies by hand and there&#39;s a lot of boilerplate to add two numbers together but in real world scenarios all you really need to do is register your command handlers in the appropriate place, for example if you&#39;re using ASP.Net Core then all the dependency injection boilerplate is in place.</p>
<div id="disqus_thread"></div>
            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/JamesRandall/AzureFromTheTrenches.Commanding/blob/master/docfx/guides/gettingStarted.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                  <li>
                    <a href="#disqus_thread" class="contribution-link">0 Comments</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright © 2018 James Randall
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script id="dsq-count-scr" src="//docfx-github.disqus.com/count.js" async=""></script>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-20735760-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-20735760-7');
    </script>
    
    <script defer="" src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+" crossorigin="anonymous"></script>  </body>
</html>
